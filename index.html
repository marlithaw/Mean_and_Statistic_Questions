<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Day 2: Understanding Mean (with Song)</title>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Lexend:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* ===== RESET & BASE ===== */
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Lexend', sans-serif;
      background: #1a1a2e;
      color: #fff;
      overflow: hidden;
      user-select: none;
    }

    /* ===== SLIDE CONTAINER ===== */
    .slide-container { width: 100vw; height: 100vh; position: relative; }

    .slide {
      width: 100%; height: 100%;
      display: none; flex-direction: column;
      justify-content: center; align-items: center;
      padding: 3rem 4rem 5rem;
      position: absolute; top: 0; left: 0;
      overflow-y: auto;
    }

    .slide.active {
      display: flex;
      animation: slideIn 0.6s cubic-bezier(.4,0,.2,1);
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(60px) scale(0.97); }
      to   { opacity: 1; transform: translateX(0) scale(1); }
    }
    @keyframes slideOut {
      from { opacity: 1; transform: translateX(0); }
      to   { opacity: 0; transform: translateX(-60px); }
    }

    .slide-content {
      max-width: 1100px; width: 100%; text-align: center;
      animation: contentFade 0.8s ease 0.1s both;
    }
    @keyframes contentFade {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* ===== TYPOGRAPHY ===== */
    h1 {
      font-family: 'Fredoka', sans-serif;
      font-size: 3.5rem; margin-bottom: 1.5rem;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
      letter-spacing: 2px;
    }
    h2 {
      font-family: 'Fredoka', sans-serif;
      font-size: 2.6rem; margin-bottom: 1.2rem;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }
    h3 {
      font-size: 1.7rem; margin-bottom: 0.8rem;
      color: #FDE68A;
    }
    p, li {
      font-size: 1.5rem; line-height: 1.6; margin-bottom: 0.8rem;
    }

    /* ===== LYRICS & SONG ===== */
    .lyrics {
      background: rgba(255,255,255,0.12);
      backdrop-filter: blur(12px);
      padding: 1.5rem 2rem; border-radius: 1.2rem;
      border: 3px solid rgba(255,255,255,0.25);
      margin: 1.5rem 0; font-size: 1.6rem; line-height: 1.8;
      position: relative;
    }
    .song-line {
      font-weight: 600; margin: 0.6rem 0; font-size: 1.8rem;
      cursor: pointer; padding: 0.3rem 0.8rem; border-radius: 0.5rem;
      transition: all 0.4s ease;
    }
    .song-line:hover { background: rgba(255,255,255,0.15); }
    .song-line.karaoke-active {
      background: rgba(255,255,0,0.3);
      transform: scale(1.05);
      text-shadow: 0 0 20px rgba(255,255,0,0.6);
      color: #FDE68A;
    }
    .song-line.karaoke-done {
      opacity: 0.5;
    }

    .karaoke-btn {
      background: linear-gradient(135deg, #ff6b6b, #ee5a24);
      border: none; color: white; padding: 0.7rem 1.5rem;
      font-size: 1.1rem; font-weight: 700; border-radius: 2rem;
      cursor: pointer; margin: 0.8rem 0.4rem;
      transition: all 0.3s; font-family: 'Lexend', sans-serif;
      box-shadow: 0 4px 15px rgba(238,90,36,0.4);
    }
    .karaoke-btn:hover { transform: scale(1.08); box-shadow: 0 6px 20px rgba(238,90,36,0.6); }
    .karaoke-btn.audio-btn {
      background: linear-gradient(135deg, #a29bfe, #6c5ce7);
      box-shadow: 0 4px 15px rgba(108,92,231,0.4);
    }

    /* ===== FORMULA & STEP BOXES ===== */
    .formula {
      background: #FDE68A; color: #1a1a2e;
      padding: 1.5rem 2.5rem; border-radius: 1rem;
      font-size: 2.5rem; font-weight: 700; margin: 1.5rem 0;
      box-shadow: 0 8px 25px rgba(0,0,0,0.3);
      display: inline-block;
    }
    .step-box {
      background: rgba(255,255,255,0.12);
      padding: 1.2rem 1.5rem; border-radius: 1rem;
      margin: 0.8rem 0; border-left: 6px solid #FDE68A;
      backdrop-filter: blur(8px);
      text-align: left;
    }

    /* ===== SLIDE THEMES ===== */
    .slide-song { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .slide-intro { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .slide-teaching { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
    .slide-practice { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
    .slide-valentine { background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%); }

    /* ===== IMAGES ===== */
    .slide-image {
      width: 85%; max-width: 800px;
      border-radius: 1rem; margin: 1.2rem auto;
      box-shadow: 0 8px 30px rgba(0,0,0,0.3);
      border: 4px solid rgba(255,255,255,0.3);
      display: block;
      transition: transform 0.3s;
    }
    .slide-image:hover { transform: scale(1.02); }

    /* ===== NAVIGATION ===== */
    .navigation {
      position: fixed; bottom: 1.2rem; left: 50%;
      transform: translateX(-50%);
      display: flex; gap: 0.8rem; z-index: 1000;
      align-items: center;
    }
    .nav-btn {
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255,255,255,0.4);
      color: white; padding: 0.8rem 1.5rem;
      font-size: 1.1rem; font-weight: 600;
      border-radius: 0.5rem; cursor: pointer;
      transition: all 0.3s; font-family: 'Lexend', sans-serif;
    }
    .nav-btn:hover { background: rgba(255,255,255,0.35); transform: scale(1.05); }
    .nav-btn:disabled { opacity: 0.3; cursor: not-allowed; transform: none; }

    /* ===== SLIDE NUMBER ===== */
    .slide-number {
      position: fixed; top: 1.2rem; right: 1.5rem;
      background: rgba(0,0,0,0.4); backdrop-filter: blur(10px);
      padding: 0.4rem 1rem; border-radius: 2rem;
      font-size: 1rem; z-index: 1000;
    }

    /* ===== PROGRESS DOTS ===== */
    .progress-dots {
      position: fixed; top: 1.2rem; left: 50%;
      transform: translateX(-50%);
      display: flex; gap: 6px; z-index: 1000;
      background: rgba(0,0,0,0.3); backdrop-filter: blur(10px);
      padding: 0.5rem 1rem; border-radius: 2rem;
    }
    .progress-dot {
      width: 12px; height: 12px; border-radius: 50%;
      background: rgba(255,255,255,0.3);
      transition: all 0.3s; cursor: pointer;
    }
    .progress-dot.active { background: #FDE68A; transform: scale(1.3); box-shadow: 0 0 8px rgba(253,230,138,0.6); }
    .progress-dot.visited { background: rgba(255,255,255,0.7); }
    .progress-dot:hover { transform: scale(1.4); }

    /* ===== TOOLBAR ===== */
    .toolbar {
      position: fixed; top: 1.2rem; left: 1.2rem;
      display: flex; gap: 0.5rem; z-index: 1000;
    }
    .toolbar-btn {
      background: rgba(0,0,0,0.4); backdrop-filter: blur(10px);
      border: 2px solid rgba(255,255,255,0.2);
      color: white; width: 40px; height: 40px;
      border-radius: 50%; cursor: pointer;
      font-size: 1.1rem; display: flex;
      align-items: center; justify-content: center;
      transition: all 0.3s;
    }
    .toolbar-btn:hover { background: rgba(255,255,255,0.2); transform: scale(1.1); }

    /* ===== TEACHER NOTES PANEL ===== */
    .notes-panel {
      position: fixed; top: 0; right: -400px;
      width: 380px; height: 100vh;
      background: rgba(20,20,40,0.95); backdrop-filter: blur(20px);
      z-index: 2000; padding: 2rem 1.5rem;
      transition: right 0.4s cubic-bezier(.4,0,.2,1);
      border-left: 3px solid rgba(255,255,255,0.15);
      overflow-y: auto;
    }
    .notes-panel.open { right: 0; }
    .notes-panel h3 { color: #FDE68A; margin-bottom: 1rem; font-size: 1.4rem; }
    .notes-textarea {
      width: 100%; height: 200px;
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 0.8rem; color: white;
      padding: 1rem; font-family: 'Lexend', sans-serif;
      font-size: 1rem; resize: vertical;
    }
    .notes-textarea:focus { outline: none; border-color: #FDE68A; }
    .notes-close {
      position: absolute; top: 1rem; right: 1rem;
      background: none; border: none; color: white;
      font-size: 1.5rem; cursor: pointer;
    }

    /* ===== INTERACTIVE ELEMENTS ===== */
    .interactive-input {
      background: rgba(255,255,255,0.15);
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 0.8rem; color: white;
      padding: 0.8rem 1.2rem; font-size: 1.4rem;
      font-family: 'Lexend', sans-serif;
      width: 200px; text-align: center;
      transition: all 0.3s;
    }
    .interactive-input:focus {
      outline: none; border-color: #FDE68A;
      background: rgba(255,255,255,0.25);
      box-shadow: 0 0 15px rgba(253,230,138,0.3);
    }
    .interactive-input::placeholder { color: rgba(255,255,255,0.4); }

    .check-btn {
      background: linear-gradient(135deg, #00b894, #00cec9);
      border: none; color: white;
      padding: 0.7rem 1.8rem; font-size: 1.2rem;
      font-weight: 700; border-radius: 2rem;
      cursor: pointer; transition: all 0.3s;
      font-family: 'Lexend', sans-serif;
      box-shadow: 0 4px 15px rgba(0,206,201,0.4);
      margin: 0.5rem;
    }
    .check-btn:hover { transform: scale(1.08); }

    .hint-btn {
      background: linear-gradient(135deg, #fdcb6e, #e17055);
      border: none; color: white;
      padding: 0.5rem 1.2rem; font-size: 1rem;
      font-weight: 600; border-radius: 2rem;
      cursor: pointer; transition: all 0.3s;
      font-family: 'Lexend', sans-serif;
    }
    .hint-btn:hover { transform: scale(1.05); }

    .hint-box {
      display: none; background: rgba(253,203,110,0.2);
      border: 2px solid #fdcb6e; border-radius: 0.8rem;
      padding: 1rem; margin-top: 0.8rem;
      font-style: italic; font-size: 1.2rem;
    }
    .hint-box.show { display: block; animation: fadeIn 0.4s ease; }

    .reveal-step {
      opacity: 0; transform: translateY(15px);
      transition: all 0.5s ease; pointer-events: none;
    }
    .reveal-step.revealed {
      opacity: 1; transform: translateY(0); pointer-events: auto;
    }

    .feedback {
      font-size: 1.4rem; font-weight: 700;
      padding: 0.8rem; border-radius: 0.8rem;
      margin-top: 0.5rem; display: none;
    }
    .feedback.correct {
      display: block; background: rgba(0,184,148,0.3);
      border: 2px solid #00b894; color: #55efc4;
      animation: popIn 0.5s cubic-bezier(.4,0,.2,1);
    }
    .feedback.incorrect {
      display: block; background: rgba(214,48,49,0.3);
      border: 2px solid #d63031; color: #ff7675;
      animation: shake 0.5s ease;
    }

    @keyframes popIn {
      0% { transform: scale(0.5); opacity: 0; }
      70% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }
    @keyframes shake {
      0%,100% { transform: translateX(0); }
      20% { transform: translateX(-10px); }
      40% { transform: translateX(10px); }
      60% { transform: translateX(-10px); }
      80% { transform: translateX(10px); }
    }
    @keyframes fadeIn {
      from { opacity: 0; } to { opacity: 1; }
    }
    @keyframes bounce {
      0%,100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }

    /* ===== TIMER ===== */
    .timer-container {
      display: inline-flex; align-items: center; gap: 0.8rem;
      background: rgba(0,0,0,0.3); padding: 0.8rem 1.5rem;
      border-radius: 2rem; margin: 1rem 0;
    }
    .timer-display {
      font-size: 2.5rem; font-weight: 700;
      font-family: 'Fredoka', sans-serif;
      min-width: 80px;
    }
    .timer-btn {
      background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);
      color: white; padding: 0.4rem 1rem; border-radius: 1rem;
      cursor: pointer; font-size: 0.9rem; font-weight: 600;
      font-family: 'Lexend', sans-serif; transition: all 0.3s;
    }
    .timer-btn:hover { background: rgba(255,255,255,0.3); }
    .timer-warning { color: #ff7675; animation: bounce 0.5s infinite; }

    /* ===== WORD CLOUD ===== */
    .word-cloud-area {
      display: flex; flex-wrap: wrap; gap: 0.6rem;
      justify-content: center; padding: 1rem;
      min-height: 80px;
    }
    .word-tag {
      background: rgba(255,255,255,0.2); padding: 0.4rem 1rem;
      border-radius: 2rem; font-size: 1.1rem; font-weight: 600;
      animation: popIn 0.4s ease;
      border: 2px solid rgba(255,255,255,0.3);
    }

    /* ===== GOT IT BUTTON ===== */
    .got-it-btn {
      background: linear-gradient(135deg, #636e72, #b2bec3);
      border: 3px solid rgba(255,255,255,0.3);
      color: white; padding: 1rem 3rem;
      font-size: 1.5rem; font-weight: 700;
      border-radius: 3rem; cursor: pointer;
      transition: all 0.4s; font-family: 'Fredoka', sans-serif;
      margin-top: 1.5rem;
    }
    .got-it-btn:hover { transform: scale(1.05); }
    .got-it-btn.activated {
      background: linear-gradient(135deg, #00b894, #55efc4);
      box-shadow: 0 0 30px rgba(0,184,148,0.5);
      animation: popIn 0.5s ease;
    }

    /* ===== EXIT TICKET ===== */
    .exit-input {
      background: rgba(255,255,255,0.15);
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 0.8rem; color: white;
      padding: 0.8rem 1.2rem; font-size: 1.3rem;
      font-family: 'Lexend', sans-serif;
      width: 100%; transition: all 0.3s;
    }
    .exit-input:focus {
      outline: none; border-color: #FDE68A;
      background: rgba(255,255,255,0.25);
    }
    .exit-input::placeholder { color: rgba(255,255,255,0.4); }

    /* ===== CONFETTI ===== */
    .confetti-piece {
      position: fixed; width: 10px; height: 10px;
      z-index: 3000; pointer-events: none;
      animation: confettiFall linear forwards;
    }
    @keyframes confettiFall {
      0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
      100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
    }

    /* ===== BADGE ===== */
    .achievement-badge {
      display: none; background: linear-gradient(135deg, #f9ca24, #f0932b);
      color: #1a1a2e; padding: 1.5rem 2.5rem;
      border-radius: 1.5rem; font-size: 1.3rem;
      font-weight: 700; margin-top: 1.5rem;
      box-shadow: 0 8px 30px rgba(240,147,43,0.5);
      border: 4px solid rgba(255,255,255,0.5);
    }
    .achievement-badge.show {
      display: inline-block;
      animation: popIn 0.6s cubic-bezier(.4,0,.2,1);
    }

    /* ===== GRID ===== */
    .grid-2 {
      display: grid; grid-template-columns: 1fr 1fr;
      gap: 1.5rem; margin: 1.5rem 0;
    }

    .candy-visual { font-size: 1.5rem; margin: 0.3rem 0; }

    .emoji-large { font-size: 5rem; margin: 0.8rem 0; }

    .highlight {
      background: linear-gradient(to bottom, transparent 50%, #FDE68A 50%);
      color: #1a1a2e; padding: 0.2rem 0.5rem; font-weight: 700;
    }

    ul { text-align: left; max-width: 800px; margin: 0 auto; }

    /* ===== FULLSCREEN ===== */
    .fullscreen-active .toolbar,
    .fullscreen-active .slide-number { opacity: 0; transition: opacity 0.3s; }
    .fullscreen-active:hover .toolbar,
    .fullscreen-active:hover .slide-number { opacity: 1; }

    /* ===== PRINT STYLES ===== */
    @media print {
      body { background: white; color: black; overflow: visible; }
      .slide {
        display: flex !important; position: relative !important;
        page-break-after: always; height: auto; min-height: 90vh;
        padding: 2rem; background: white !important;
        color: black !important;
      }
      .slide * { color: black !important; text-shadow: none !important; }
      .navigation, .toolbar, .slide-number, .progress-dots,
      .notes-panel, .karaoke-btn, .check-btn, .hint-btn,
      .timer-container, .got-it-btn { display: none !important; }
      .slide-image { max-width: 500px; box-shadow: none; border: 2px solid #ccc; }
      .formula { box-shadow: none; border: 2px solid #333; }
      .lyrics, .step-box { border-color: #333; background: #f5f5f5 !important; }
      h1, h2, h3 { color: #333 !important; }
      .highlight { background: #ff0 !important; color: black !important; }
    }

    /* ===== RESPONSIVE ===== */
    @media (max-width: 768px) {
      .slide { padding: 1.5rem 1.5rem 4rem; }
      h1 { font-size: 2.2rem; }
      h2 { font-size: 1.8rem; }
      h3 { font-size: 1.3rem; }
      p, li { font-size: 1.1rem; }
      .formula { font-size: 1.6rem; padding: 1rem 1.5rem; }
      .lyrics { font-size: 1.1rem; padding: 1rem; }
      .song-line { font-size: 1.3rem; }
      .grid-2 { grid-template-columns: 1fr; }
      .slide-image { width: 95%; }
      .progress-dots { display: none; }
      .emoji-large { font-size: 3rem; }
    }
  </style>
</head>
<body>

  <!-- TOOLBAR -->
  <div class="toolbar">
    <button class="toolbar-btn" onclick="toggleFullscreen()" title="Fullscreen">&#x26F6;</button>
    <button class="toolbar-btn" onclick="toggleNotes()" title="Teacher Notes">&#x1F4DD;</button>
    <button class="toolbar-btn" onclick="resetProgress()" title="Reset Progress">&#x21BA;</button>
  </div>

  <!-- PROGRESS DOTS -->
  <div class="progress-dots" id="progressDots"></div>

  <!-- SLIDE NUMBER -->
  <div class="slide-number" id="slideNumber">Slide 1 / 20</div>

  <!-- TEACHER NOTES PANEL -->
  <div class="notes-panel" id="notesPanel">
    <button class="notes-close" onclick="toggleNotes()">&times;</button>
    <h3>Teacher Notes</h3>
    <p style="font-size:0.9rem; opacity:0.7; margin-bottom:1rem;">Notes are saved per slide and persist during this session.</p>
    <textarea class="notes-textarea" id="notesTextarea" placeholder="Type your notes for this slide..."></textarea>
  </div>

  <div class="slide-container">

    <!-- ==================== SLIDE 1: Title ==================== -->
    <div class="slide active slide-song" data-slide="0">
      <div class="slide-content">
        <div class="emoji-large">&#127925;</div>
        <h1>THE MEAN SONG</h1>
        <h2>+ Understanding Mean</h2>
        <p style="font-size:1.8rem; margin-top:1.5rem;">Grade 6 Data &amp; Statistics | Day 2</p>
        <p style="font-size:1.3rem; opacity:0.9;">&#128157; Valentine's Edition &#128157;</p>
        <img src="7_____1_20260210_211739.png" alt="Lee and Tee - your guides!" class="slide-image" style="max-width:500px; margin-top:1rem;">
      </div>
    </div>

    <!-- ==================== SLIDE 2: Song Intro ==================== -->
    <div class="slide slide-song" data-slide="1">
      <div class="slide-content">
        <h2>&#127908; [INTRO] &#127908;</h2>
        <div class="lyrics" id="lyrics-intro">
          <p class="song-line karaoke-line" data-group="intro">Count it... split it...</p>
        </div>
        <div style="margin:1rem 0;">
          <button class="karaoke-btn audio-btn" onclick="alert('Audio placeholder - add your audio file!')">&#127911; Play Audio</button>
          <button class="karaoke-btn" onclick="startKaraoke('intro')">&#127908; Karaoke Mode</button>
        </div>
        <img src="1______DAY_2__MEAN___U_1_20260210_211617.png" alt="Whiteboard: count it, split it" class="slide-image">
      </div>
    </div>

    <!-- ==================== SLIDE 3: Chorus Part 1 ==================== -->
    <div class="slide slide-song" data-slide="2">
      <div class="slide-content">
        <h2>&#127925; [CHORUS] &#127925;</h2>
        <div class="lyrics" id="lyrics-chorus1">
          <p class="song-line karaoke-line" data-group="chorus1">Add it up &mdash; count it up &mdash; divide it clean</p>
        </div>
        <div style="margin:2rem 0;">
          <div style="font-size:2.5rem; margin:0.8rem;">&#10133; ADD IT UP</div>
          <div style="font-size:2.5rem; margin:0.8rem;">&#128290; COUNT IT UP</div>
          <div style="font-size:2.5rem; margin:0.8rem;">&#10135; DIVIDE IT CLEAN</div>
        </div>
        <p style="font-size:1.3rem;">&#128079; Clap on each step!</p>
        <div style="margin-top:0.8rem;">
          <button class="karaoke-btn audio-btn" onclick="alert('Audio placeholder - add your audio file!')">&#127911; Play Audio</button>
          <button class="karaoke-btn" onclick="startKaraoke('chorus1')">&#127908; Karaoke Mode</button>
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 4: Chorus Part 2 ==================== -->
    <div class="slide slide-song" data-slide="3">
      <div class="slide-content">
        <h2>&#127925; [CHORUS CONTINUED] &#127925;</h2>
        <div class="lyrics" id="lyrics-chorus2">
          <p class="song-line karaoke-line" data-group="chorus2">Total, divide by the number count,</p>
          <p class="song-line karaoke-line" data-group="chorus2">That's the mean, that's the mean.</p>
          <p class="song-line karaoke-line" data-group="chorus2">Total, divide by the number count,</p>
          <p class="song-line karaoke-line" data-group="chorus2">That's the mean, that's the mean.</p>
        </div>
        <div class="formula" style="margin-top:2rem;">TOTAL &divide; COUNT = MEAN</div>
        <p style="font-size:1.3rem; margin-top:1.5rem;">Point to each word as we sing! &#128073;</p>
        <div style="margin-top:0.8rem;">
          <button class="karaoke-btn audio-btn" onclick="alert('Audio placeholder - add your audio file!')">&#127911; Play Audio</button>
          <button class="karaoke-btn" onclick="startKaraoke('chorus2')">&#127908; Karaoke Mode</button>
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 5: Verse ==================== -->
    <div class="slide slide-song" data-slide="4">
      <div class="slide-content">
        <h2>&#127908; [VERSE] &#127908;</h2>
        <div class="lyrics" id="lyrics-verse">
          <p class="song-line karaoke-line" data-group="verse">Mean is the av-er-age, the fair share split.</p>
          <p class="song-line karaoke-line" data-group="verse">Add every number, stack that total quick.</p>
          <p class="song-line karaoke-line" data-group="verse">Count how many numbers, keep that count on screen,</p>
          <p class="song-line karaoke-line" data-group="verse">Then divide &mdash; that result is the mean.</p>
        </div>
        <p style="font-size:1.4rem; margin-top:1.5rem;">
          Motions: Stack (add) &#9995; &rarr; Count (fingers) &#9757;&#65039; &rarr; Chop (divide) &#9986;&#65039;
        </p>
        <div style="margin-top:0.8rem;">
          <button class="karaoke-btn audio-btn" onclick="alert('Audio placeholder - add your audio file!')">&#127911; Play Audio</button>
          <button class="karaoke-btn" onclick="startKaraoke('verse')">&#127908; Karaoke Mode</button>
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 6: Full Song ==================== -->
    <div class="slide slide-song" data-slide="5">
      <div class="slide-content">
        <h2>&#127925; NOW LET'S SING IT ALL TOGETHER! &#127925;</h2>
        <div class="lyrics" id="lyrics-full" style="font-size:1.3rem;">
          <p class="song-line karaoke-line" data-group="full"><strong>[Intro]</strong> Count it... split it...</p>
          <p class="song-line karaoke-line" data-group="full"><strong>[Chorus]</strong> Add it up &mdash; count it up &mdash; divide it clean,</p>
          <p class="song-line karaoke-line" data-group="full">Total, divide by the number count, that's the mean, that's the mean.</p>
          <p class="song-line karaoke-line" data-group="full"><strong>[Verse]</strong> Mean is the av-er-age, the fair share split.</p>
          <p class="song-line karaoke-line" data-group="full">Add every number, stack that total quick.</p>
          <p class="song-line karaoke-line" data-group="full">Count how many numbers, keep that count on screen,</p>
          <p class="song-line karaoke-line" data-group="full">Then divide &mdash; that result is the mean.</p>
        </div>
        <p style="font-size:1.6rem; margin-top:1.5rem;">&#127908; Stand up and perform! &#127908;</p>
        <div style="margin-top:0.8rem;">
          <button class="karaoke-btn audio-btn" onclick="alert('Audio placeholder - add your audio file!')">&#127911; Play Audio</button>
          <button class="karaoke-btn" onclick="startKaraoke('full')">&#127908; Karaoke Mode</button>
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 7: Lee's Introduction ==================== -->
    <div class="slide slide-intro" data-slide="6">
      <div class="slide-content">
        <h2>&#128172; LEE SAYS...</h2>
        <div class="step-box" style="font-size:1.5rem;">
          <p>"Hey everyone! Yesterday we learned about <strong>STATISTICAL QUESTIONS</strong> - remember those?</p>
          <p style="margin-top:0.8rem;">You worked REALLY hard on your math test, and I want to make sure we keep building on what we learned!"</p>
        </div>
        <img src="19_____1_20260210_212017.png" alt="Lee and Tee waving" class="slide-image" style="max-width:450px; margin-top:1rem;">
        <h3 style="margin-top:1.5rem;">Let's do a quick Think-Ink-Share! &#129504;</h3>
      </div>
    </div>

    <!-- ==================== SLIDE 8: Think-Ink-Share ==================== -->
    <div class="slide slide-intro" data-slide="7">
      <div class="slide-content">
        <h2>&#129300; THINK-INK-SHARE</h2>

        <!-- Timer -->
        <div class="timer-container">
          <span class="timer-display" id="timerDisplay">0:30</span>
          <button class="timer-btn" onclick="startTimer(30)">30s Think</button>
          <button class="timer-btn" onclick="startTimer(60)">1m Ink</button>
          <button class="timer-btn" onclick="stopTimer()">Stop</button>
        </div>

        <div class="grid-2" style="margin-top:1.5rem;">
          <div class="step-box">
            <h3>&#129504; THINK</h3>
            <p>What words come to mind when you hear "STATISTICS"?</p>
            <p style="font-size:1.2rem;">(30 seconds)</p>
          </div>
          <div class="step-box">
            <h3>&#9997;&#65039; INK</h3>
            <p>Write 2-3 words in your notebook</p>
            <p style="font-size:1.2rem;">(1 minute)</p>
          </div>
        </div>

        <div class="step-box" style="margin-top:1rem;">
          <h3>&#128172; SHARE</h3>
          <div style="display:flex; gap:0.5rem; align-items:center; flex-wrap:wrap; justify-content:center; margin:0.8rem 0;">
            <input type="text" class="interactive-input" id="wordInput" placeholder="Type a word..." style="width:220px; font-size:1.1rem;" onkeydown="if(event.key==='Enter') addWord()">
            <button class="check-btn" onclick="addWord()" style="font-size:1rem;">Add Word</button>
          </div>
          <div class="word-cloud-area" id="wordCloud"></div>
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 9: What IS Statistics? ==================== -->
    <div class="slide slide-intro" data-slide="8">
      <div class="slide-content">
        <h2>&#128202; WHAT IS STATISTICS?</h2>
        <div class="step-box" style="font-size:1.6rem; margin:1.5rem 0;">
          <p>Statistics is the study of collecting, organizing, analyzing, and interpreting <span class="highlight">DATA</span>.</p>
        </div>
        <p style="font-size:1.4rem; margin:1.5rem 0;">
          In other words: Statistics helps us make sense of <strong>NUMBERS</strong> and <strong>INFORMATION</strong>!
        </p>
        <h3 style="margin-top:1.5rem;">Examples:</h3>
        <ul style="font-size:1.3rem;">
          <li>How many Valentine's cards did we get?</li>
          <li>What's the average score on our test?</li>
          <li>Which lunch option is most popular?</li>
        </ul>
        <img src="21_16_9_classroom_white_1_20260210_193631.png" alt="Quick Review whiteboard" class="slide-image" style="max-width:550px; margin-top:1rem;">
      </div>
    </div>

    <!-- ==================== SLIDE 10: Learning Target ==================== -->
    <div class="slide slide-intro" data-slide="9">
      <div class="slide-content">
        <h2>&#127919; TODAY'S GOAL</h2>
        <div class="step-box" style="font-size:1.5rem;">
          <p>I can find the <span class="highlight">MEAN</span> (average) by:</p>
          <ol style="margin-top:0.8rem; margin-left:2rem;">
            <li>Adding all the numbers together</li>
            <li>Dividing by how many numbers there are</li>
          </ol>
        </div>
        <div class="formula" style="margin:1.5rem 0;">Mean = Total &divide; Count</div>
        <p style="font-size:1.4rem;">&#127925; Remember the song?</p>
        <p style="font-size:1.5rem; font-style:italic; margin-top:0.8rem;">
          "Add it up, count it up, divide it clean!"
        </p>

        <!-- Got it button -->
        <div style="margin-top:1rem;">
          <label style="font-size:1.2rem; cursor:pointer; display:inline-flex; align-items:center; gap:0.5rem;">
            <input type="checkbox" id="understandCheck" style="width:22px; height:22px; cursor:pointer;" onchange="checkUnderstand()">
            I understand today's goal
          </label>
        </div>
        <button class="got-it-btn" id="gotItBtn" onclick="activateGotIt()">Got it!</button>
      </div>
    </div>

    <!-- ==================== SLIDE 11: Valentine's Candy Problem ==================== -->
    <div class="slide slide-valentine" data-slide="10">
      <div class="slide-content">
        <h2>&#128157; THE VALENTINE'S CANDY PROBLEM &#128157;</h2>
        <p style="font-size:1.4rem; margin-bottom:1rem;">
          Lee, Tee, Gael, and Christian went to the Valentine's party. They all got candy!
        </p>
        <div class="candy-visual">
          <p><strong>Lee:</strong> 12 pieces &#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;</p>
          <p><strong>Tee:</strong> 8 pieces &#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;</p>
          <p><strong>Gael:</strong> 10 pieces &#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;&#127852;</p>
          <p><strong>Christian:</strong> 6 pieces &#127852;&#127852;&#127852;&#127852;&#127852;&#127852;</p>
        </div>
        <img src="2_______PROMPT_1__Vale_1_20260210_211629.png" alt="Valentine's Candy Bags" class="slide-image" style="max-width:600px;">
        <h3 style="margin-top:1rem;">What's the "FAIR SHARE"?</h3>
        <div style="margin-top:0.5rem;">
          <input type="text" class="interactive-input" id="fairShareGuess" placeholder="?" style="width:120px;">
          <button class="check-btn" onclick="checkAnswer('fairShareGuess','9','fairShareFB')">Check</button>
        </div>
        <div class="feedback" id="fairShareFB"></div>
      </div>
    </div>

    <!-- ==================== SLIDE 12: Leveling Out ==================== -->
    <div class="slide slide-valentine" data-slide="11">
      <div class="slide-content">
        <h2>&#128157; LEVELING OUT = MEAN</h2>
        <div class="grid-2">
          <div>
            <h3>BEFORE (Uneven)</h3>
            <div style="text-align:left; font-size:1.3rem; margin-top:0.5rem;">
              <p>Lee: &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608; (12)</p>
              <p>Tee: &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608; (8)</p>
              <p>Gael: &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608; (10)</p>
              <p>Christian: &#9608;&#9608;&#9608;&#9608;&#9608;&#9608; (6)</p>
            </div>
          </div>
          <div>
            <h3>AFTER (Fair)</h3>
            <div style="text-align:left; font-size:1.3rem; margin-top:0.5rem;">
              <p>Lee: &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608; (9)</p>
              <p>Tee: &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608; (9)</p>
              <p>Gael: &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608; (9)</p>
              <p>Christian: &#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608;&#9608; (9)</p>
            </div>
          </div>
        </div>
        <div class="formula" style="margin-top:1.5rem;">36 &divide; 4 = 9</div>
        <img src="5_Create_a_16_9_classr_1_20260210_20318.png" alt="Fair Share Visual - Before and After" class="slide-image" style="max-width:600px;">
      </div>
    </div>

    <!-- ==================== SLIDE 13: Step 1 - Add ==================== -->
    <div class="slide slide-teaching" data-slide="12">
      <div class="slide-content">
        <h2>STEP 1: ADD ALL THE NUMBERS</h2>
        <p class="song-line" style="font-size:1.6rem; font-style:italic; color:#FDE68A;">
          &#127925; "Add every number, stack that total quick!" &#127925;
        </p>

        <div class="reveal-step revealed" id="step1-q">
          <p style="font-size:1.6rem; margin:1rem 0;">12 + 8 + 10 + 6 = ?</p>
          <input type="text" class="interactive-input" id="step1Answer" placeholder="?">
          <button class="check-btn" onclick="checkAndReveal('step1Answer','36','step1FB','step1-result')">Check</button>
          <div class="feedback" id="step1FB"></div>
        </div>

        <div class="reveal-step" id="step1-result">
          <div class="formula" style="margin:1.5rem 0;">12 + 8 + 10 + 6 = 36</div>
          <p style="font-size:1.6rem;">This is the <span class="highlight">TOTAL</span> (or SUM) of all pieces.</p>
        </div>

        <img src="1______DAY_2__MEAN___U_1_20260210_211617.png" alt="Step 1 - Add All Numbers" class="slide-image" style="max-width:550px;">

        <div style="margin-top:0.8rem;">
          <button class="hint-btn" onclick="toggleHint('hint-step1')">&#128161; Show Hint</button>
          <div class="hint-box" id="hint-step1">&#127925; "Add every number, stack that total quick!" - Just add all four numbers together!</div>
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 14: Step 2 - Count ==================== -->
    <div class="slide slide-teaching" data-slide="13">
      <div class="slide-content">
        <h2>STEP 2: COUNT HOW MANY NUMBERS</h2>
        <p class="song-line" style="font-size:1.6rem; font-style:italic; color:#FDE68A;">
          &#127925; "Count how many numbers, keep that count on screen!" &#127925;
        </p>
        <div style="margin:1.5rem 0;">
          <p style="font-size:1.6rem;">Dataset: 12, 8, 10, 6</p>
          <div style="font-size:2.5rem; margin:1.5rem 0;">&#9312; &#9313; &#9314; &#9315;</div>

          <div class="reveal-step revealed" id="step2-q">
            <p style="font-size:1.4rem;">How many numbers are there?</p>
            <input type="text" class="interactive-input" id="step2Answer" placeholder="?">
            <button class="check-btn" onclick="checkAndReveal('step2Answer','4','step2FB','step2-result')">Check</button>
            <div class="feedback" id="step2FB"></div>
          </div>

          <div class="reveal-step" id="step2-result">
            <div class="formula">COUNT = 4 numbers</div>
          </div>
        </div>

        <img src="11_______PROMPT_4__Step_1_20260210_211833.png" alt="Step 2 - Count How Many Numbers" class="slide-image" style="max-width:500px;">

        <div style="margin-top:0.8rem;">
          <button class="hint-btn" onclick="toggleHint('hint-step2')">&#128161; Show Hint</button>
          <div class="hint-box" id="hint-step2">&#127925; "Count how many numbers, keep that count on screen" - How many friends shared candy?</div>
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 15: Step 3 - Divide ==================== -->
    <div class="slide slide-teaching" data-slide="14">
      <div class="slide-content">
        <h2>STEP 3: DIVIDE TOTAL &divide; COUNT</h2>
        <p class="song-line" style="font-size:1.6rem; font-style:italic; color:#FDE68A;">
          &#127925; "Then divide &mdash; that result is the mean!" &#127925;
        </p>

        <div class="reveal-step revealed" id="step3-q">
          <p style="font-size:1.6rem; margin:1rem 0;">36 &divide; 4 = ?</p>
          <input type="text" class="interactive-input" id="step3Answer" placeholder="?">
          <button class="check-btn" onclick="checkAndReveal('step3Answer','9','step3FB','step3-result')">Check</button>
          <div class="feedback" id="step3FB"></div>
        </div>

        <div class="reveal-step" id="step3-result">
          <div class="formula" style="font-size:3rem; margin:1.5rem 0;">36 &divide; 4 = 9</div>
          <p style="font-size:2rem;">Each person gets <span class="highlight">9 pieces!</span></p>
        </div>

        <img src="4_Create_a_16_9_classr_1_20260210_2034.png" alt="Step 3 - Divide Total by Count" class="slide-image" style="max-width:550px;">

        <div style="margin-top:0.8rem;">
          <button class="hint-btn" onclick="toggleHint('hint-step3')">&#128161; Show Hint</button>
          <div class="hint-box" id="hint-step3">&#127925; "Then divide - that result is the mean!" - Take the total (36) and divide by the count (4)!</div>
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 16: Fair Share ==================== -->
    <div class="slide slide-teaching" data-slide="15">
      <div class="slide-content">
        <h2>FAIR SHARE = MEAN</h2>
        <p class="song-line" style="font-size:1.6rem; font-style:italic; color:#FDE68A;">
          &#127925; "Mean is the av-er-age, the fair share split!" &#127925;
        </p>
        <div style="margin:1.5rem 0; font-size:1.6rem;">
          <p>Each person gets the SAME amount:</p>
          <p style="margin:0.8rem 0;">9 + 9 + 9 + 9 = 36</p>
        </div>
        <div class="formula" style="margin:1.5rem 0;">&#9733; MEAN = 9 &#9733;</div>
        <img src="22_____1_20260210_212055.png" alt="Lee and Tee - Fair Share" class="slide-image" style="max-width:450px;">
      </div>
    </div>

    <!-- ==================== SLIDE 17: Number Line ==================== -->
    <div class="slide slide-teaching" data-slide="16">
      <div class="slide-content">
        <h2>MEAN = THE CENTER POINT</h2>
        <p style="font-size:1.6rem; margin-bottom:1.5rem;">The mean balances all the data!</p>
        <img src="20_______PROMPT_7__Numb_1_20260210_212031.png" alt="Number Line Showing Mean as Center Point" class="slide-image" style="max-width:700px;">
      </div>
    </div>

    <!-- ==================== SLIDE 18: Practice Problem ==================== -->
    <div class="slide slide-practice" data-slide="17">
      <div class="slide-content">
        <h2>FIND THE MEAN</h2>
        <p style="font-size:1.6rem; margin-bottom:1.5rem;">
          Tee's basketball scores: <strong>6, 8, 10, 12</strong>
        </p>
        <p style="font-size:1.3rem; font-style:italic; margin-bottom:1rem;">
          &#127925; Use the song to help you! &#127925;
        </p>

        <div class="step-box" style="font-size:1.4rem;">
          <div class="reveal-step revealed" id="practice-s1">
            <p><strong>Step 1:</strong> 6 + 8 + 10 + 12 =
              <input type="text" class="interactive-input" id="prac1" placeholder="?" style="width:100px; font-size:1.2rem;">
              <button class="check-btn" onclick="checkAndReveal('prac1','36','pracFB1','practice-s2')" style="font-size:1rem;">Check</button>
            </p>
            <div class="feedback" id="pracFB1"></div>
          </div>

          <div class="reveal-step" id="practice-s2">
            <p><strong>Step 2:</strong> Count =
              <input type="text" class="interactive-input" id="prac2" placeholder="?" style="width:100px; font-size:1.2rem;">
              scores
              <button class="check-btn" onclick="checkAndReveal('prac2','4','pracFB2','practice-s3')" style="font-size:1rem;">Check</button>
            </p>
            <div class="feedback" id="pracFB2"></div>
          </div>

          <div class="reveal-step" id="practice-s3">
            <p><strong>Step 3:</strong> Total &divide; Count =
              <input type="text" class="interactive-input" id="prac3" placeholder="?" style="width:100px; font-size:1.2rem;">
              <button class="check-btn" onclick="checkAnswer('prac3','9','pracFB3')" style="font-size:1rem;">Check</button>
            </p>
            <div class="feedback" id="pracFB3"></div>
          </div>
        </div>

        <img src="24_Create_a_16_9_classr_1_20260210_212124.png" alt="Practice Problem - Find the Mean" class="slide-image" style="max-width:550px; margin-top:1rem;">

        <div style="margin-top:0.8rem;">
          <button class="hint-btn" onclick="toggleHint('hint-practice')">&#128161; Show Hint</button>
          <div class="hint-box" id="hint-practice">&#127925; "Add it up - count it up - divide it clean, Total divide by the number count, that's the mean!"</div>
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 19: Exit Ticket ==================== -->
    <div class="slide slide-practice" data-slide="18">
      <div class="slide-content">
        <h2>EXIT TICKET</h2>
        <img src="18_16_9_classroom_white_1_20260210_193554.png" alt="Exit Ticket Whiteboard" class="slide-image" style="max-width:500px; margin-bottom:1rem;">

        <div class="step-box">
          <h3>Part 1: Calculate</h3>
          <p style="font-size:1.5rem;">Dataset: <strong>5, 9, 12, 10</strong></p>
          <div style="margin:0.8rem 0;">
            <span style="font-size:1.4rem;">Mean = </span>
            <input type="text" class="interactive-input" id="exitAnswer" placeholder="?" style="width:120px;">
            <button class="check-btn" onclick="checkExitTicket()">Check Answer</button>
          </div>
          <div class="feedback" id="exitFB1"></div>
        </div>

        <div class="step-box" style="margin-top:1rem;">
          <h3>Part 2: Explain</h3>
          <div style="display:flex; gap:0.5rem; flex-wrap:wrap; align-items:center;">
            <span style="font-size:1.2rem;">"The mean is like</span>
            <input type="text" class="exit-input" id="exitExplain1" placeholder="..." style="width:200px; font-size:1.1rem; display:inline-block;">
            <span style="font-size:1.2rem;">because</span>
            <input type="text" class="exit-input" id="exitExplain2" placeholder="..." style="width:200px; font-size:1.1rem; display:inline-block;">
            <span style="font-size:1.2rem;">"</span>
          </div>
        </div>

        <div class="step-box" style="margin-top:1rem;">
          <h3>&#127925; Bonus</h3>
          <p style="font-size:1.3rem;">Write the first line of our song!</p>
          <input type="text" class="exit-input" id="exitBonus" placeholder="Add it up..." style="margin-top:0.5rem;">
        </div>
      </div>
    </div>

    <!-- ==================== SLIDE 20: Closure ==================== -->
    <div class="slide slide-song" data-slide="19">
      <div class="slide-content">
        <div class="emoji-large">&#127881;</div>
        <h2>YOU DID IT!</h2>
        <div style="font-size:1.4rem; margin:1.5rem 0; text-align:left; max-width:700px; margin-left:auto; margin-right:auto;">
          <p>&#9989; Statistics = study of data</p>
          <p>&#9989; Mean = "Fair share" or "Average"</p>
          <p>&#9989; How to calculate: Add all &divide; Count</p>
          <p>&#9989; <strong>THE MEAN SONG!</strong></p>
        </div>
        <div class="lyrics" style="margin-top:1.5rem;">
          <p class="song-line">&#127925; Add it up &mdash; count it up &mdash; divide it clean,</p>
          <p class="song-line">Total, divide by the number count,</p>
          <p class="song-line">that's the mean, that's the mean! &#127925;</p>
        </div>
        <p style="font-size:1.6rem; margin-top:1.5rem;">Let's sing it ONE MORE TIME! &#127908;</p>

        <button class="check-btn" onclick="celebrateFinish()" style="font-size:1.3rem; padding:0.8rem 2.5rem; margin-top:1rem;">
          &#127881; Celebrate! &#127881;
        </button>

        <div class="achievement-badge" id="achieveBadge">
          &#127942; ACHIEVEMENT UNLOCKED &#127942;<br>
          <span style="font-size:1.6rem;">I Learned the Mean Song!</span><br>
          <span style="font-size:1rem; opacity:0.8;">Grade 6 Data &amp; Statistics - Day 2</span>
        </div>
      </div>
    </div>

  </div>

  <!-- NAVIGATION -->
  <div class="navigation">
    <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)">&#9664; Previous</button>
    <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">Next &#9654;</button>
  </div>

  <script>
    /* ===== CORE SLIDE NAVIGATION ===== */
    let currentSlide = 0;
    const slides = document.querySelectorAll('.slide');
    const totalSlides = slides.length;
    const visitedSlides = new Set([0]);
    const teacherNotes = {};

    // Build progress dots
    const dotsContainer = document.getElementById('progressDots');
    for (let i = 0; i < totalSlides; i++) {
      const dot = document.createElement('div');
      dot.className = 'progress-dot' + (i === 0 ? ' active' : '');
      dot.title = 'Slide ' + (i + 1);
      dot.onclick = () => { currentSlide = i; showSlide(currentSlide); };
      dotsContainer.appendChild(dot);
    }

    function showSlide(n) {
      if (n >= totalSlides) currentSlide = totalSlides - 1;
      if (n < 0) currentSlide = 0;

      slides.forEach(s => s.classList.remove('active'));
      slides[currentSlide].classList.add('active');
      visitedSlides.add(currentSlide);

      document.getElementById('slideNumber').textContent = 'Slide ' + (currentSlide + 1) + ' / ' + totalSlides;
      document.getElementById('prevBtn').disabled = currentSlide === 0;
      document.getElementById('nextBtn').disabled = currentSlide === totalSlides - 1;

      // Update progress dots
      document.querySelectorAll('.progress-dot').forEach((dot, i) => {
        dot.className = 'progress-dot';
        if (i === currentSlide) dot.classList.add('active');
        else if (visitedSlides.has(i)) dot.classList.add('visited');
      });

      // Save/load teacher notes
      saveCurrentNote();
      loadNoteForSlide(currentSlide);

      // Reset karaoke on slide change
      resetKaraoke();
    }

    function changeSlide(dir) {
      currentSlide += dir;
      showSlide(currentSlide);
    }

    document.addEventListener('keydown', function(e) {
      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
      if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); changeSlide(1); }
      else if (e.key === 'ArrowLeft') { e.preventDefault(); changeSlide(-1); }
      else if (e.key === 'f') toggleFullscreen();
      else if (e.key === 'n') toggleNotes();
    });

    showSlide(0);

    /* ===== KARAOKE MODE ===== */
    let karaokeActive = false;
    let karaokeGroup = '';
    let karaokeIndex = 0;
    let karaokeLines = [];

    function startKaraoke(group) {
      resetKaraoke();
      karaokeGroup = group;
      karaokeLines = document.querySelectorAll('.karaoke-line[data-group="' + group + '"]');
      if (karaokeLines.length === 0) return;
      karaokeActive = true;
      karaokeIndex = 0;
      karaokeLines.forEach(l => { l.classList.remove('karaoke-active', 'karaoke-done'); });
      karaokeLines[0].classList.add('karaoke-active');

      // Click anywhere on lyrics to advance
      karaokeLines.forEach(l => {
        l.onclick = advanceKaraoke;
      });
    }

    function advanceKaraoke() {
      if (!karaokeActive) return;
      if (karaokeIndex < karaokeLines.length) {
        karaokeLines[karaokeIndex].classList.remove('karaoke-active');
        karaokeLines[karaokeIndex].classList.add('karaoke-done');
      }
      karaokeIndex++;
      if (karaokeIndex < karaokeLines.length) {
        karaokeLines[karaokeIndex].classList.add('karaoke-active');
        karaokeLines[karaokeIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
      } else {
        karaokeActive = false;
        // Flash all lines as finished
        karaokeLines.forEach(l => {
          l.classList.remove('karaoke-done');
          l.style.opacity = '1';
        });
      }
    }

    function resetKaraoke() {
      karaokeActive = false;
      document.querySelectorAll('.karaoke-line').forEach(l => {
        l.classList.remove('karaoke-active', 'karaoke-done');
        l.onclick = null;
      });
    }

    /* ===== TIMER ===== */
    let timerInterval = null;
    let timerSeconds = 0;

    function startTimer(secs) {
      stopTimer();
      timerSeconds = secs;
      updateTimerDisplay();
      timerInterval = setInterval(() => {
        timerSeconds--;
        updateTimerDisplay();
        if (timerSeconds <= 0) {
          stopTimer();
          document.getElementById('timerDisplay').textContent = "TIME!";
          document.getElementById('timerDisplay').classList.add('timer-warning');
        }
      }, 1000);
    }

    function stopTimer() {
      if (timerInterval) clearInterval(timerInterval);
      timerInterval = null;
      document.getElementById('timerDisplay').classList.remove('timer-warning');
    }

    function updateTimerDisplay() {
      const m = Math.floor(timerSeconds / 60);
      const s = timerSeconds % 60;
      document.getElementById('timerDisplay').textContent = m + ':' + (s < 10 ? '0' : '') + s;
    }

    /* ===== WORD CLOUD ===== */
    const defaultWords = ['data', 'numbers', 'graphs', 'average', 'charts', 'mean', 'count'];
    let wordList = [];

    function addWord() {
      const input = document.getElementById('wordInput');
      const word = input.value.trim();
      if (!word) return;
      wordList.push(word);
      renderWordCloud();
      input.value = '';
      input.focus();
    }

    function renderWordCloud() {
      const cloud = document.getElementById('wordCloud');
      const colors = ['#FDE68A', '#a29bfe', '#fd79a8', '#55efc4', '#fdcb6e', '#74b9ff', '#ff7675', '#81ecec'];
      cloud.innerHTML = '';
      wordList.forEach((w, i) => {
        const tag = document.createElement('span');
        tag.className = 'word-tag';
        tag.textContent = w;
        tag.style.background = colors[i % colors.length] + '33';
        tag.style.borderColor = colors[i % colors.length];
        tag.style.color = colors[i % colors.length];
        tag.style.fontSize = (1 + Math.random() * 0.6) + 'rem';
        cloud.appendChild(tag);
      });
    }

    /* ===== GOT IT BUTTON ===== */
    function checkUnderstand() {
      const btn = document.getElementById('gotItBtn');
      if (document.getElementById('understandCheck').checked) {
        btn.style.background = 'linear-gradient(135deg, #00b894, #55efc4)';
      } else {
        btn.style.background = '';
        btn.classList.remove('activated');
      }
    }

    function activateGotIt() {
      const btn = document.getElementById('gotItBtn');
      btn.classList.add('activated');
      btn.textContent = 'Got it! ';
    }

    /* ===== ANSWER CHECKING ===== */
    function checkAnswer(inputId, correct, fbId) {
      const val = document.getElementById(inputId).value.trim();
      const fb = document.getElementById(fbId);
      if (val === correct) {
        fb.className = 'feedback correct';
        fb.textContent = getEncouragement();
      } else {
        fb.className = 'feedback incorrect';
        fb.textContent = val ? 'Not quite - try again!' : 'Type your answer first!';
      }
    }

    function checkAndReveal(inputId, correct, fbId, revealId) {
      const val = document.getElementById(inputId).value.trim();
      const fb = document.getElementById(fbId);
      if (val === correct) {
        fb.className = 'feedback correct';
        fb.textContent = getEncouragement();
        setTimeout(() => {
          document.getElementById(revealId).classList.add('revealed');
        }, 600);
      } else {
        fb.className = 'feedback incorrect';
        fb.textContent = val ? 'Not quite - try again!' : 'Type your answer first!';
      }
    }

    function getEncouragement() {
      const msgs = [
        'Awesome! You got it! ', 'That\'s correct! ', 'Amazing work! ',
        'You\'re a math star! ', 'Nailed it! ', 'Perfect! Keep it up! ',
        'Brilliant! ', 'Way to go! '
      ];
      return msgs[Math.floor(Math.random() * msgs.length)];
    }

    /* ===== EXIT TICKET ===== */
    function checkExitTicket() {
      const val = document.getElementById('exitAnswer').value.trim();
      const fb = document.getElementById('exitFB1');
      if (val === '9') {
        fb.className = 'feedback correct';
        fb.textContent = ' Correct! (5+9+12+10) = 36, then 36  4 = 9. You\'ve mastered the mean!';
      } else {
        fb.className = 'feedback incorrect';
        fb.textContent = val ? 'Not quite! Remember: Add all numbers, then divide by the count. Try again!' : 'Type your answer!';
      }
    }

    /* ===== HINTS ===== */
    function toggleHint(id) {
      document.getElementById(id).classList.toggle('show');
    }

    /* ===== TEACHER NOTES ===== */
    function toggleNotes() {
      document.getElementById('notesPanel').classList.toggle('open');
    }

    function saveCurrentNote() {
      const ta = document.getElementById('notesTextarea');
      if (ta.value.trim()) {
        teacherNotes[currentSlide] = ta.value;
      }
    }

    function loadNoteForSlide(n) {
      document.getElementById('notesTextarea').value = teacherNotes[n] || '';
    }

    /* ===== FULLSCREEN ===== */
    function toggleFullscreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(() => {});
        document.body.classList.add('fullscreen-active');
      } else {
        document.exitFullscreen();
        document.body.classList.remove('fullscreen-active');
      }
    }

    /* ===== RESET PROGRESS ===== */
    function resetProgress() {
      if (!confirm('Reset all progress? This clears answers, words, and visited slides.')) return;
      visitedSlides.clear();
      visitedSlides.add(0);
      currentSlide = 0;
      showSlide(0);
      wordList = [];
      renderWordCloud();
      document.querySelectorAll('.interactive-input, .exit-input').forEach(i => i.value = '');
      document.querySelectorAll('.feedback').forEach(f => { f.className = 'feedback'; f.textContent = ''; });
      document.querySelectorAll('.reveal-step').forEach(r => r.classList.remove('revealed'));
      document.querySelectorAll('.reveal-step:first-child, [id$="-q"]').forEach(r => r.classList.add('revealed'));
      document.getElementById('gotItBtn').classList.remove('activated');
      document.getElementById('gotItBtn').textContent = 'Got it!';
      document.getElementById('understandCheck').checked = false;
      document.getElementById('achieveBadge').classList.remove('show');
      Object.keys(teacherNotes).forEach(k => delete teacherNotes[k]);
      document.getElementById('notesTextarea').value = '';
    }

    /* ===== CONFETTI & CELEBRATION ===== */
    function celebrateFinish() {
      launchConfetti();
      setTimeout(() => {
        document.getElementById('achieveBadge').classList.add('show');
      }, 800);
    }

    function launchConfetti() {
      const colors = ['#FDE68A', '#f093fb', '#4facfe', '#43e97b', '#fa709a', '#ff9a9e', '#00f2fe', '#f5576c'];
      for (let i = 0; i < 80; i++) {
        setTimeout(() => {
          const piece = document.createElement('div');
          piece.className = 'confetti-piece';
          piece.style.left = Math.random() * 100 + 'vw';
          piece.style.background = colors[Math.floor(Math.random() * colors.length)];
          piece.style.width = (6 + Math.random() * 10) + 'px';
          piece.style.height = (6 + Math.random() * 10) + 'px';
          piece.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
          piece.style.animationDuration = (2 + Math.random() * 3) + 's';
          document.body.appendChild(piece);
          setTimeout(() => piece.remove(), 5000);
        }, i * 30);
      }
    }
  </script>
</body>
</html>
